{"version":3,"sources":["../../src/validators/validator.js"],"names":["getMessage","msg","transformToObject","prev","current","Object","assign","adaptRuleAndMsg","valRulesAndMsg","key","keys","rules","map","rule","messages","reduce","adaptConstraints","Validate","setConstraints","constraints","formData","errorMsgs"],"mappings":";;;;;;;;AAAA;;;;AACA;;AACA;;AACA;;AACA;;AACA;;;;;;;;AAEA,SAASA,UAAT,CAAoBC,GAApB,EAAyB;AACvB,MAAI,OAAOA,GAAP,KAAe,UAAnB,EAA+B;AAC7B,WAAOA,GAAP;AACD;;AAED,eAAWA,GAAX;AACD;;AAED,SAASC,iBAAT,CAA2BC,IAA3B,EAAiCC,OAAjC,EAA0C;AACxC,SAAOC,OAAOC,MAAP,CAAcH,IAAd,EAAoBC,OAApB,CAAP;AACD;;AAED,SAASG,eAAT,CAAyBC,cAAzB,EAAyCC,GAAzC,EAA8C;AAC5C,SAAOJ,OAAOK,IAAP,CAAYF,eAAeG,KAAf,CAAqBF,GAArB,CAAZ,EACJG,GADI,CACA;AAAA;;AAAA,+BACFC,IADE,sCAEAA,IAFA,EAEOL,eAAeG,KAAf,CAAqBF,GAArB,EAA0BI,IAA1B,CAFP,qCAGQb,WAAWQ,eAAeM,QAAf,CAAwBL,GAAxB,EAA6BI,IAA7B,CAAX,CAHR;AAAA,GADA,EAOJE,MAPI,CAOGb,iBAPH,EAOsB,EAPtB,CAAP;AAQD;;AAED,SAASc,gBAAT,CAA0BR,cAA1B,EAA0C;AACxC,SAAOH,OAAOK,IAAP,CAAYF,eAAeG,KAA3B,EACJC,GADI,CACA;AAAA,+BAAWH,GAAX,EAAiBF,gBAAgBC,cAAhB,EAAgCC,GAAhC,CAAjB;AAAA,GADA,EAEJM,MAFI,CAEGb,iBAFH,EAEsB,EAFtB,CAAP;AAGD;;IAEoBe,Q;AACnB,oBAAYT,cAAZ,EAA4B;AAAA;;AAC1B,SAAKU,cAAL,CAAoBV,cAApB;AACD;;;;mCAEcA,c,EAAgB;AAC7B,WAAKW,WAAL,GAAmBH,iBAAiBR,cAAjB,CAAnB;AACD;;;6BAEQY,Q,EAA0C;AAAA,UAAhCD,WAAgC,uEAAlB,KAAKA,WAAa;;AACjD,aAAO,wBAASC,QAAT,EAAmBD,WAAnB,KAAmC,EAA1C;AACD;;;2BAEMV,G,EAAKW,Q,EAA0C;AAAA,UAAhCD,WAAgC,uEAAlB,KAAKA,WAAa;;AACpD,UAAME,YAAY,wBAASD,QAAT,sBAAsBX,GAAtB,EAA4BU,YAAYV,GAAZ,CAA5B,MAAmD,EAArE;AACA,aAAOY,UAAUZ,GAAV,KAAkB,EAAzB;AACD;;;;;;kBAhBkBQ,Q","file":"validator.js","sourcesContent":["import validate from 'validate.js';\nimport './adapters/required';\nimport './adapters/minlength';\nimport './adapters/maxlength';\nimport './adapters/pattern';\nimport './adapters/equalTo';\n\nfunction getMessage(msg) {\n  if (typeof msg === 'function') {\n    return msg;\n  }\n\n  return `^${msg}`;\n}\n\nfunction transformToObject(prev, current) {\n  return Object.assign(prev, current);\n}\n\nfunction adaptRuleAndMsg(valRulesAndMsg, key) {\n  return Object.keys(valRulesAndMsg.rules[key])\n    .map(rule => ({\n      [rule]: {\n        [rule]: valRulesAndMsg.rules[key][rule],\n        message: getMessage(valRulesAndMsg.messages[key][rule])\n      }\n    }))\n    .reduce(transformToObject, {});\n}\n\nfunction adaptConstraints(valRulesAndMsg) {\n  return Object.keys(valRulesAndMsg.rules)\n    .map(key => ({ [key]: adaptRuleAndMsg(valRulesAndMsg, key) }))\n    .reduce(transformToObject, {});\n}\n\nexport default class Validate {\n  constructor(valRulesAndMsg) {\n    this.setConstraints(valRulesAndMsg);\n  }\n\n  setConstraints(valRulesAndMsg) {\n    this.constraints = adaptConstraints(valRulesAndMsg);\n  }\n\n  validate(formData, constraints = this.constraints) {\n    return validate(formData, constraints) || '';\n  }\n\n  single(key, formData, constraints = this.constraints) {\n    const errorMsgs = validate(formData, { [key]: constraints[key] }) || {};\n    return errorMsgs[key] || '';\n  }\n}\n"]}