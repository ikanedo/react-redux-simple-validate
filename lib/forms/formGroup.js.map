{"version":3,"sources":["../../src/forms/formGroup.js"],"names":["FormActions","FormGroup","props","onValidate","bind","onValueChange","onSubmit","formValidator","formName","defaultErrors","defaultValues","setInitialData","nextProps","validation","setConstraints","isTriggerValidation","triggerValidate","values","errors","children","isSameValues","isSameErrors","isSameChildren","setValidity","handleValidForm","handleInvalidForm","formData","refs","errorMsgs","validate","isValid","e","setSingleValidity","single","target","name","setInputValue","getVal","formElements","propTypes","node","isRequired","shape","rules","object","messages","func","string","mapStateToProps","state","formState","Forms"],"mappings":"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","file":"formGroup.js","sourcesContent":["import React, { PropTypes, Component } from 'react';\nimport { connect } from 'react-redux';\nimport Validator from '../validators/validator';\nimport formElementFromEvt from './formElement/formElementFromEvt';\nimport formBuilder from './formBuilder';\nimport { filterValidation, getFormData } from './formUtils';\nimport * as FormActions from './formActions';\n\nexport class FormGroup extends Component {\n  constructor(props) {\n    super(props);\n    this.onValidate = this.onValidate.bind(this);\n    this.onValueChange = this.onValueChange.bind(this);\n    this.onSubmit = this.onSubmit.bind(this);\n    this.formValidator = new Validator(\n      filterValidation(props)\n    );\n  }\n\n  componentDidMount() {\n    const {\n      formName,\n      defaultErrors,\n      defaultValues,\n      setInitialData\n    } = this.props;\n\n    if (defaultErrors || defaultValues) {\n      setInitialData(\n        formName,\n        defaultValues,\n        defaultErrors\n      );\n    }\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if (nextProps.validation !== this.props.validation) {\n      this.formValidator.setConstraints(\n        filterValidation(nextProps)\n      );\n    }\n\n    if (nextProps.isTriggerValidation) {\n      this.onSubmit();\n      this.props.triggerValidate(nextProps.formName, false);\n    }\n  }\n\n  shouldComponentUpdate(nextProps) {\n    const {\n      values,\n      errors,\n      children\n    } = this.props;\n    const isSameValues = values === nextProps.values;\n    const isSameErrors = errors === nextProps.errors;\n    const isSameChildren = children === nextProps.children;\n    return !(isSameValues && isSameErrors && isSameChildren);\n  }\n\n  onSubmit() {\n    const {\n      children,\n      formName,\n      setValidity,\n      handleValidForm,\n      handleInvalidForm = () => {}\n    } = this.props;\n    const formData = getFormData(children, this.refs);\n    const errorMsgs = this.formValidator.validate(formData);\n    setValidity(formName, errorMsgs);\n\n    const isValid = !errorMsgs;\n    if (isValid) {\n      handleValidForm(formData, formName);\n    } else {\n      handleInvalidForm(errorMsgs, formName);\n    }\n  }\n\n  onValidate(e) {\n    const {\n      children,\n      formName,\n      setSingleValidity\n    } = this.props;\n    const formData = getFormData(children, this.refs);\n    const errorMsgs = this.formValidator.single(e.target.name, formData);\n    setSingleValidity(\n      formName,\n      { [e.target.name]: errorMsgs }\n    );\n  }\n\n  onValueChange(e) {\n    const {\n      formName,\n      setInputValue\n    } = this.props;\n\n    setInputValue(\n      formName,\n      { [e.target.name]: formElementFromEvt(e).getVal() }\n    );\n  }\n\n  render() {\n    const {\n      children,\n      values,\n      errors\n    } = this.props;\n    const formElements = formBuilder({\n      onValidate: this.onValidate,\n      onValueChange: this.onValueChange,\n      values,\n      errors,\n      children\n    });\n\n    return (\n      <div className=\"form-group\">\n        {formElements}\n      </div>\n    );\n  }\n}\n\nFormGroup.propTypes = {\n  children: PropTypes.node.isRequired,\n  validation: PropTypes.shape({\n    rules: PropTypes.object.isRequired,\n    messages: PropTypes.object.isRequired\n  }),\n  handleValidForm: PropTypes.func.isRequired,\n  handleInvalidForm: PropTypes.func,\n  formName: PropTypes.string.isRequired,\n  values: PropTypes.object.isRequired,\n  errors: PropTypes.object.isRequired,\n  defaultValues: PropTypes.object,\n  defaultErrors: PropTypes.object,\n  setInitialData: PropTypes.func.isRequired,\n  setValidity: PropTypes.func.isRequired,\n  setSingleValidity: PropTypes.func.isRequired,\n  setInputValue: PropTypes.func.isRequired,\n  triggerValidate: PropTypes.func\n};\n\nfunction mapStateToProps(state, props) {\n  const formState = state.Forms[props.formName] || {};\n  return {\n    values: formState.values || {},\n    errors: formState.errors || {},\n    isTriggerValidation: !!formState.isTriggerValidation\n  };\n}\n\nexport default connect(mapStateToProps, FormActions)(FormGroup);\n"]}